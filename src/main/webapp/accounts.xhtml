<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core">
<h:head>
    <title>Счета</title>
</h:head>

<h:body>

    <h1>Список счетов</h1>

    <f:metadata>
        <f:viewParam name="userId" value="#{accountBean.userId}"/>
    </f:metadata>

    <p:dataTable id="accountTable" var="account" value="#{accountBean.getAll()}" rows="10"
                 paginator="true"
                 paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}">
        <p:column headerText="Id счета">
            <h:outputText value="#{account.id}"/>
        </p:column>

        <p:column headerText="Баланс">
            <h:outputText value="#{account.amount}"/>
        </p:column>
    </p:dataTable>

    <p:messages autoUpdate="true"/>
    <p:layout id="panel">
        <p:layoutUnit position="west" size="450">
            <h1>Добавить счет</h1>
            <h:form>
                <h:panelGrid columns="2" cellpadding="5">
                    <p:outputLabel for="amount" value="Сумма: "/>
                    <p:inputNumber id="amount" required="true" value="#{accountBean.amount}"/>

                    <p:commandButton value="Создать" update="accountTable, panel" action="#{accountBean.create()}"/>
                </h:panelGrid>
            </h:form>
        </p:layoutUnit>

        <p:layoutUnit position="center">
            <h1>Перевод между своими счетами</h1>
            <h:form>
                <h:panelGrid columns="2" cellpadding="5">
                    <p:outputLabel for="internalTransferDebitAccount" value="Со счета: "/>
                    <p:selectOneMenu id="internalTransferDebitAccount" required="true" value="#{accountBean.debitId}">
                        <f:selectItems value="#{accountBean.accountIdList}"/>
                    </p:selectOneMenu>

                    <p:outputLabel for="internalTransferRefillAccount" value="На счет: " />
                    <p:selectOneMenu id="internalTransferRefillAccount" required="true" value="#{accountBean.refillId}">
                        <f:selectItems value="#{accountBean.accountIdList}" />
                    </p:selectOneMenu>

                    <p:outputLabel for="internalTransferAmount" value="Сумма: " />
                    <p:inputNumber id="internalTransferAmount" required="true" value="#{accountBean.amount}" minValue="1"/>

                    <p:outputLabel for="internalTransferDescription" value="Описание: " />
                    <p:inputText id="internalTransferDescription" value="#{accountBean.transactionDescription}"/>

                    <p:commandButton value="Перевести" update="accountTable" action="#{accountBean.transfer}"/>
                </h:panelGrid>
            </h:form>
            <h1>Перевод другому клиенту</h1>
            <h:form>
                <h:panelGrid columns="2" cellpadding="5">
                    <p:outputLabel for="transferDebitAccount" value="Со счета: "/>
                    <p:selectOneMenu id="transferDebitAccount" required="true" value="#{accountBean.debitId}">
                        <f:selectItems value="#{accountBean.accountIdList}"/>
                    </p:selectOneMenu>

                    <p:outputLabel for="transferRefillAccount" value="На счет: " />
                    <p:inputText id="transferRefillAccount" required="true" value="#{accountBean.refillId}"/>

                    <p:outputLabel for="transferAmount" value="Сумма: " />
                    <p:inputNumber id="transferAmount" required="true" value="#{accountBean.amount}" minValue="1"/>

                    <p:outputLabel for="transferDescription" value="Описание: " />
                    <p:inputText id="transferDescription" value="#{accountBean.transactionDescription}"/>

                    <p:commandButton value="Перевести" update="accountTable" action="#{accountBean.transfer}"/>
                </h:panelGrid>
            </h:form>
        </p:layoutUnit>

        <p:layoutUnit position="east" size="450">
            <h1>Списание</h1>
            <h:form>
                <h:panelGrid columns="2" cellpadding="5">
                    <p:outputLabel for="debitAccount" value="Со счета: "/>
                    <p:selectOneMenu id="debitAccount" required="true" value="#{accountBean.debitId}">
                        <f:selectItems value="#{accountBean.accountIdList}"/>
                    </p:selectOneMenu>

                    <p:outputLabel for="debitAmount" value="Сумма: " />
                    <p:inputNumber id="debitAmount" required="true" value="#{accountBean.amount}" minValue="1"/>

                    <p:outputLabel for="debitDescription" value="Описание: " />
                    <p:inputText id="debitDescription" value="#{accountBean.transactionDescription}"/>

                    <p:commandButton value="Списать" update="accountTable" action="#{accountBean.transfer}"/>
                </h:panelGrid>
            </h:form>

            <h1>Пополнение</h1>
            <h:form>
                <h:panelGrid columns="2" cellpadding="5">
                    <p:outputLabel for="refillAccount" value="На счет: "/>
                    <p:selectOneMenu id="refillAccount" required="true" value="#{accountBean.refillId}">
                        <f:selectItems value="#{accountBean.accountIdList}"/>
                    </p:selectOneMenu>

                    <p:outputLabel for="refillAmount" value="Сумма: " />
                    <p:inputNumber id="refillAmount" value="#{accountBean.amount}" minValue="1"/>

                    <p:outputLabel for="refillDescription" value="Описание: " />
                    <p:inputText id="refillDescription" value="#{accountBean.transactionDescription}"/>

                    <p:commandButton value="Пополнить" update="accountTable" action="#{accountBean.transfer}"/>
                </h:panelGrid>
            </h:form>
        </p:layoutUnit>
    </p:layout>

</h:body>

</html>